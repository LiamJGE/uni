(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14670,        323]
NotebookOptionsPosition[     14279,        308]
NotebookOutlinePosition[     14714,        325]
CellTagsIndexPosition[     14671,        322]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"AlgCYK", "[", 
   RowBox[{"gramatica_", ",", " ", "cadena_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", " ", "j", ",", " ", "k", ",", " ", "l", ",", " ", "m", ",", 
      " ", "n", ",", " ", "V", ",", " ", "aux"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "cadena", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "\[LessEqual]", " ", "n"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aux", " ", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"j", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"gramatica", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"gramatica", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", " ", "j", ",", " ", "2"}], "]"}], "]"}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"cadena", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"aux", ",", " ", 
                RowBox[{"gramatica", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", " ", "j", ",", " ", "1", ",", " ", "1"}], 
                  "]"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "If", " ", "el", " ", "antecedente", " ", "de", " ", "la", " ", 
            "producci\[OAcute]n", " ", "j", " ", "tiene", " ", "como", " ", 
            "\[IndentingNewLine]", "  ", "consecuente", " ", "el", " ", 
            "car\[AAcute]cter", " ", "i", " ", "de", " ", "cadena"}], ",", 
           " ", 
           RowBox[{"lo", " ", "a\[NTilde]adimos", " ", "a", " ", "aux"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
        ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "For", " ", "j", " ", "itera", " ", "por", " ", "cada", " ", 
          "producci\[OAcute]n", " ", "de", " ", "la", " ", 
          "gram\[AAcute]tica"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "aux"}], "]"}], ";"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Primera", " ", "fila"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "For", " ", "i", " ", "itera", " ", "por", " ", "cada", " ", 
       "car\[AAcute]cter", " ", "de", " ", "la", " ", "cadena"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculamos", " ", "la", " ", "matriz", " ", "V"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"j", " ", "\[LessEqual]", " ", "n"}], ",", " ", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"V", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Inicializamos", " ", "la", " ", "fila", " ", "j"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", " ", "\[LessEqual]", " ", 
           RowBox[{"n", "-", "j", "+", "1"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"V", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
             RowBox[{"{", "}"}]}], "]"}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Inicializamos", " ", "la", " ", "celda", " ", "ji"}], 
            " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
             RowBox[{"k", " ", "\[LessEqual]", " ", 
              RowBox[{"j", "-", "1"}]}], ",", " ", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"aux", " ", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "Concatenaci\[OAcute]n", " ", "de", " ", "los", " ", 
                 "elementos", " ", "de", " ", "la", " ", "lista", " ", "Vki", 
                 " ", "con", "\[IndentingNewLine]", "   ", "los", " ", 
                 "elementos", " ", "de", " ", "la", " ", "lista", " ", "Vj"}],
                 "-", 
                RowBox[{"k", " ", "i"}], "+", "k"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"l", " ", "=", " ", "1"}], ",", " ", 
                RowBox[{"l", " ", "\[LessEqual]", " ", 
                 RowBox[{"Length", "[", 
                  RowBox[{"V", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}]}], ",", " ", 
                RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"m", " ", "=", " ", "1"}], ",", " ", 
                   RowBox[{"m", " ", "\[LessEqual]", " ", 
                    RowBox[{"Length", "[", 
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "-", "k"}], ",", " ", 
                    RowBox[{"i", "+", "k"}]}], "]"}], "]"}], "]"}]}], ",", 
                   " ", 
                   RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"aux", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", " ", "l"}], "]"}], " ", "]"}],
                     ",", 
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "-", "k"}], ",", " ", 
                    RowBox[{"i", "+", "k"}], ",", " ", "m"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               RowBox[{"(*", " ", 
                RowBox[{"For", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]",
                "\[IndentingNewLine]", "]"}], ";", 
              RowBox[{"(*", " ", 
               RowBox[{"For", " ", "l"}], " ", "*)"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "A\[NTilde]adimos", " ", "a", " ", "Vji", " ", "los", " ", 
                 "antecedente", " ", "que", " ", "producen", " ", "los", " ", 
                 "caracteres", "\[IndentingNewLine]", " ", "de", " ", "la", 
                 " ", "cadena", " ", "\"\<cadena\>\"", " ", "desde", " ", 
                 "posici\[OAcute]n", " ", "i", " ", "hasta", " ", "la", " ", 
                 "posici\[OAcute]n", " ", "i"}], "+", "j"}], "  ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"l", " ", "=", " ", "1"}], ",", " ", 
                RowBox[{"l", " ", "\[LessEqual]", " ", 
                 RowBox[{"Length", "[", 
                  RowBox[{"gramatica", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", " ", 
                RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"aux", ",", " ", 
                    RowBox[{"gramatica", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", " ", "l", ",", " ", "2"}], "]"}], 
                    "]"}]}], "]"}], " ", "\[NotEqual]", " ", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"gramatica", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", " ", "l", ",", " ", "1"}], "]"}], 
                    "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", " ", 
                   RowBox[{"A", ":", "A"}]}], " ", "\[Rule]", " ", 
                  RowBox[{"BC", " ", "\[Epsilon]", " ", "P"}]}], ",", " ", 
                 RowBox[{"B", " ", "\[Epsilon]", " ", "Vik"}], ",", " ", 
                 RowBox[{
                  RowBox[{"C", " ", "\[Epsilon]", " ", "Vi"}], "+", "k"}], 
                 ",", 
                 RowBox[{"j", "-", "k"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
            RowBox[{"(*", " ", 
             RowBox[{"For", " ", "l"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"For", " ", "k"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "For", " ", "j", " ", "itera", " ", "por", " ", "cada", " ", 
       "car\[AAcute]cter", " ", "de", " ", "la", " ", "cadena"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"gramatica", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  RowBox[{"(*", " ", "AlgCYK", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.82436349017971*^9, 3.824363577079283*^9}, {
   3.8243636139120855`*^9, 3.824363676695414*^9}, {3.824363712656308*^9, 
   3.8243639192869368`*^9}, {3.8243640465432415`*^9, 3.824364073318688*^9}, {
   3.824364133103677*^9, 3.8243645395836277`*^9}, {3.8243646901585875`*^9, 
   3.824364706327383*^9}, {3.8243647569789133`*^9, 3.8243648398630285`*^9}, 
   3.8245508403365755`*^9, {3.824551093416873*^9, 3.824551098058919*^9}, {
   3.8245515315780168`*^9, 3.824551575455818*^9}, {3.8245516164894667`*^9, 
   3.8245516171765203`*^9}, {3.824551656168893*^9, 3.8245516854727397`*^9}, 
   3.8245519174894032`*^9, {3.824552149078746*^9, 3.8245521850333*^9}, {
   3.8245522403361783`*^9, 3.8245522724321504`*^9}, {3.8245525191351757`*^9, 
   3.8245525196884995`*^9}, {3.8245525525939837`*^9, 
   3.8245525527193575`*^9}, {3.824552590390972*^9, 3.824552860014919*^9}, {
   3.8245529353992167`*^9, 3.824553164278299*^9}, {3.8245532093920374`*^9, 
   3.8245535434697313`*^9}, {3.8245537087510786`*^9, 3.824553861758303*^9}, {
   3.824553892702779*^9, 3.82455394018165*^9}, {3.824553979001063*^9, 
   3.8245540602653236`*^9}, {3.8245541291501656`*^9, 3.824554131425247*^9}, {
   3.8245541692770967`*^9, 3.824554210326647*^9}, {3.8245542444853992`*^9, 
   3.8245542705500655`*^9}, {3.824554614517288*^9, 3.824554866117136*^9}, {
   3.8245549057971506`*^9, 3.8245549155411935`*^9}, {3.8245549657350993`*^9, 
   3.8245550376386223`*^9}, {3.8245551265808735`*^9, 3.824555129515874*^9}, {
   3.824555199429037*^9, 3.8245552593968873`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"d768ca58-34cb-439c-ae09-b06372c300f1"]
},
WindowSize->{1428., 741.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6b4af55b-9c2f-4586-ab75-e3ce6b9d242e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 13717, 286, 1990, "Input",ExpressionUUID->"d768ca58-34cb-439c-ae09-b06372c300f1"]
}
]
*)

